"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[447],{4447:(Se,h,p)=>{p.r(h),p.d(h,{EmployeesModule:()=>Oe});var r=p(6814),y=p(1896),k=p(9862),e=p(5879),c=p(8789),d=p(4170),T=p(2032),x=p(1476),l=p(6223),b=p(3519),u=p.n(b),g=p(4104),C=p(3680),f=p(8034),v=p(7466),w=p(8525),m=p(1545),q=p(617),Z=p(292);function E(s,i){1&s&&(e.TgZ(0,"mat-icon"),e._uU(1,"check"),e.qZA())}function I(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"mat-radio-button",21),e._uU(2),e.qZA(),e._UZ(3,"br"),e.BQk()),2&s){const t=i.$implicit;e.xp6(1),e.s9C("value",t.value),e.xp6(1),e.Oqu(t.name)}}function F(s,i){if(1&s&&(e.TgZ(0,"div",12)(1,"h6",13),e._uU(2,"Please select on which date you want to schedule tasks for employee:"),e.qZA(),e.TgZ(3,"mat-form-field",22),e._UZ(4,"input",23)(5,"mat-datepicker-toggle",24)(6,"mat-datepicker",null,25),e.qZA()()),2&s){const t=e.MAs(7);e.xp6(4),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t)}}function U(s,i){1&s&&(e.TgZ(0,"div",26)(1,"h6",13),e._uU(2,"Please select from which date - to which date you want to schedule tasks for employee:"),e.qZA()())}function N(s,i){if(1&s&&(e.TgZ(0,"div",27)(1,"mat-form-field",28),e._UZ(2,"input",29)(3,"mat-datepicker-toggle",24)(4,"mat-datepicker",null,25),e.qZA()()),2&s){const t=e.MAs(5);e.xp6(2),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t)}}function J(s,i){if(1&s&&(e.TgZ(0,"div",27)(1,"mat-form-field",28),e._UZ(2,"input",30)(3,"mat-datepicker-toggle",24)(4,"mat-datepicker",null,31),e.qZA()()),2&s){const t=e.MAs(5);e.xp6(2),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t)}}function M(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"mat-step",11)(1,"div",6)(2,"div",12)(3,"h6",13),e._uU(4,"How would you like to Schedule the tasks?"),e.qZA(),e.TgZ(5,"mat-radio-group",14),e.NdJ("change",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.scheduleTypeChanged(a))}),e.YNc(6,I,4,2,"ng-container",15),e.qZA()(),e.YNc(7,F,8,2,"div",16),e.YNc(8,U,3,0,"div",17),e.YNc(9,N,6,2,"div",18),e.YNc(10,J,6,2,"div",18),e.TgZ(11,"div",19)(12,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.employeeTasksFormGroupChanged?a.addSchedules():"")}),e._uU(13,"Proceed"),e.qZA()()()()}if(2&s){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.employeeTasksFormGroup),e.xp6(5),e.Q6J("ngForOf",t.api.employee_task_duration_types),e.xp6(1),e.Q6J("ngIf","single_day"==t.employeeTasksFormGroup.value.task_duration_type),e.xp6(1),e.Q6J("ngIf","multi_day"==t.employeeTasksFormGroup.value.task_duration_type),e.xp6(1),e.Q6J("ngIf","multi_day"==t.employeeTasksFormGroup.value.task_duration_type),e.xp6(1),e.Q6J("ngIf","multi_day"==t.employeeTasksFormGroup.value.task_duration_type),e.xp6(2),e.Q6J("disabled",!t.employeeTasksFormGroup.valid)}}function Q(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",27)(1,"h6",13),e._uU(2,"Task start time:"),e.qZA(),e.TgZ(3,"mat-form-field",47),e._UZ(4,"input",48),e.TgZ(5,"mat-icon",49),e.NdJ("click",function(){e.CHM(t);const a=e.MAs(8);return e.KtG(a.open())}),e._uU(6,"watch_later"),e.qZA()(),e._UZ(7,"ngx-mat-timepicker",50,51),e.qZA()}if(2&s){const t=e.MAs(8);e.xp6(4),e.Q6J("ngxMatTimepicker",t)}}function G(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",27)(1,"h6",13),e._uU(2,"Task end time:"),e.qZA(),e.TgZ(3,"mat-form-field",47),e._UZ(4,"input",52),e.TgZ(5,"mat-icon",49),e.NdJ("click",function(){e.CHM(t);const a=e.MAs(8);return e.KtG(a.open())}),e._uU(6,"watch_later"),e.qZA()(),e._UZ(7,"ngx-mat-timepicker",50,53),e.qZA()}if(2&s){const t=e.MAs(8);e.xp6(4),e.Q6J("ngxMatTimepicker",t)}}function O(s,i){if(1&s&&(e.TgZ(0,"mat-option",21),e._uU(1),e.qZA()),2&s){const t=i.$implicit;e.Q6J("value",t.value),e.xp6(1),e.Oqu(t.name)}}function D(s,i){1&s&&(e.ynx(0),e.TgZ(1,"h6",13),e._uU(2,"Location to visit:"),e.qZA(),e.TgZ(3,"div",27)(4,"mat-form-field",28)(5,"mat-label"),e._uU(6,"Street"),e.qZA(),e._UZ(7,"input",54),e.qZA()(),e.TgZ(8,"div",27)(9,"mat-form-field",28)(10,"mat-label"),e._uU(11,"Locality, Area"),e.qZA(),e._UZ(12,"input",55),e.qZA()(),e.TgZ(13,"div",56)(14,"mat-form-field",28)(15,"mat-label"),e._uU(16,"City"),e.qZA(),e._UZ(17,"input",57),e.qZA()(),e.TgZ(18,"div",56)(19,"mat-form-field",28)(20,"mat-label"),e._uU(21,"State"),e.qZA(),e._UZ(22,"input",58),e.qZA()(),e.TgZ(23,"div",56)(24,"mat-form-field",28)(25,"mat-label"),e._uU(26,"PinCode"),e.qZA(),e._UZ(27,"input",59),e.qZA()(),e.BQk())}function S(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",60)(1,"button",61),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).index,n=e.oxw().$implicit;return e.KtG(n.controls.tasks.removeAt(a))}),e._uU(2),e.qZA()()}if(2&s){const t=e.oxw(2).index;e.xp6(2),e.hij("Remove Task No. ",t+1,"")}}function Y(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",12)(2,"h6",13),e._uU(3,"Would you like to add start & end time for this task ? (For e.g. 10:00 AM to 11:00 AM)"),e.qZA(),e.TgZ(4,"mat-radio-group",42),e.NdJ("change",function(a){e.CHM(t);const n=e.oxw().$implicit,_=e.oxw(2);return e.KtG(_.taskTimingRequiremntChange(a,n))}),e.TgZ(5,"mat-radio-button",21),e._uU(6,"Yes"),e.qZA(),e.TgZ(7,"mat-radio-button",21),e._uU(8,"No"),e.qZA()()(),e.YNc(9,Q,9,1,"div",18),e.YNc(10,G,9,1,"div",18),e.TgZ(11,"div",12)(12,"h6",13),e._uU(13,"Please select task type:"),e.qZA(),e.TgZ(14,"mat-form-field",28)(15,"mat-select",43),e.NdJ("selectionChange",function(a){e.CHM(t);const n=e.oxw().$implicit,_=e.oxw(2);return e.KtG(_.taskTypeChanged(a,n))}),e.YNc(16,O,2,2,"mat-option",44),e.qZA()()(),e.YNc(17,D,28,0,"ng-container",41),e.TgZ(18,"div",12)(19,"h6",13),e._uU(20,"Description:"),e.qZA(),e.TgZ(21,"mat-form-field",28)(22,"mat-label"),e._uU(23,"Task description"),e.qZA(),e._UZ(24,"textarea",45),e.qZA()(),e.YNc(25,S,3,1,"div",46),e.BQk()}if(2&s){const t=e.oxw().$implicit,o=e.oxw().$implicit,a=e.oxw();e.xp6(5),e.Q6J("value",!0),e.xp6(2),e.Q6J("value",!1),e.xp6(2),e.Q6J("ngIf",t.value.task_timing),e.xp6(1),e.Q6J("ngIf",t.value.task_timing),e.xp6(6),e.Q6J("ngForOf",a.api.employee_tasks_types),e.xp6(1),e.Q6J("ngIf","marketing_location"==t.value.task_type),e.xp6(8),e.Q6J("ngIf",o.controls.tasks.length>1)}}function V(s,i){if(1&s&&(e.TgZ(0,"div",64)(1,"p",65),e._uU(2,"Task timing: "),e.TgZ(3,"strong"),e._uU(4),e.qZA()()()),2&s){const t=e.oxw(2).$implicit;e.xp6(4),e.AsE("From ",t.value.from," to ",t.value.to,"")}}function B(s,i){if(1&s&&(e.TgZ(0,"div",1)(1,"p",65),e._uU(2,"Location to visit: "),e.TgZ(3,"strong"),e._uU(4),e.qZA()()()),2&s){const t=e.oxw(2).$implicit;e.xp6(4),e.xDo(" ",t.value.street?t.value.street+",":""," ",t.value.locality,", ",t.value.city,", ",t.value.state,", ",t.value.pinCode," ")}}function z(s,i){if(1&s&&(e.TgZ(0,"div",64)(1,"p",65),e._uU(2),e.qZA()()),2&s){const t=e.oxw(2).$implicit;e.xp6(2),e.hij("Description: ",t.value.description,"")}}function L(s,i){if(1&s&&(e.ynx(0),e.YNc(1,V,5,2,"div",62),e.YNc(2,B,5,5,"div",63),e.YNc(3,z,3,1,"div",62),e.BQk()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.value.task_timing),e.xp6(1),e.Q6J("ngIf","marketing_location"==t.value.task_type),e.xp6(1),e.Q6J("ngIf",t.value.description)}}function H(s,i){if(1&s&&(e.TgZ(0,"div",38)(1,"div",39)(2,"h6",40),e._uU(3),e.ALo(4,"date"),e.qZA()(),e.YNc(5,Y,26,7,"ng-container",41),e.YNc(6,L,4,3,"ng-container",41),e.qZA()),2&s){const t=i.index,o=e.oxw().$implicit,a=e.oxw();e.Q6J("formGroupName",t),e.xp6(3),e.AsE("","week_days_wise"==a.employeeTasksFormGroup.value.task_duration_type?o.value.tasks_day:e.xi3(4,5,o.value.tasks_date,"dd/MM/yyyy"),"'s Task No. ",t+1,":"),e.xp6(2),e.Q6J("ngIf",!a.viewMode),e.xp6(1),e.Q6J("ngIf",a.viewMode)}}function K(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",66)(1,"button",67),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().index,n=e.oxw();return e.KtG(n.addTask(a))}),e._uU(2),e.ALo(3,"date"),e.qZA()()}if(2&s){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.Q6J("disabled",!t.controls.tasks.controls.at(-1).valid),e.xp6(1),e.hij("Add Task for ","week_days_wise"==o.employeeTasksFormGroup.value.task_duration_type?t.value.tasks_day:e.xi3(3,2,t.value.tasks_date,"dd/MM/yyyy"),"")}}function j(s,i){if(1&s&&(e.TgZ(0,"div",68)(1,"h6",13),e._uU(2),e.qZA()()),2&s){const t=e.oxw().$implicit,o=e.oxw();e.xp6(2),e.AsE("",t.value.tasks_day," is holiday for ",(null==o.employee_details||null==o.employee_details.user_id?null:o.employee_details.user_id.title)+" "+(null==o.employee_details||null==o.employee_details.user_id?null:o.employee_details.user_id.firstname)+" "+(null==o.employee_details||null==o.employee_details.user_id?null:o.employee_details.user_id.lastname),".")}}function P(s,i){if(1&s&&(e.TgZ(0,"mat-tab",32),e.ALo(1,"date"),e.ynx(2,33),e.YNc(3,H,7,8,"div",34),e.BQk(),e.TgZ(4,"div",35),e.YNc(5,K,4,5,"div",36),e.YNc(6,j,3,2,"div",37),e.qZA()()),2&s){const t=i.$implicit,o=i.index,a=e.oxw();e.Q6J("formGroupName",o)("label","week_days_wise"==a.employeeTasksFormGroup.value.task_duration_type?t.value.tasks_day:e.xi3(1,5,t.value.tasks_date,"dd/MM/yyyy")+" ("+t.value.tasks_day+")"),e.xp6(3),e.Q6J("ngForOf",t.get("tasks").controls),e.xp6(2),e.Q6J("ngIf",(null==t.controls||null==t.controls.tasks?null:t.controls.tasks.length)>0&&!a.viewMode),e.xp6(1),e.Q6J("ngIf",0==(null==t.controls||null==t.controls.tasks?null:t.controls.tasks.length))}}function R(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",69)(1,"button",70),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.revisitingFirstStep())}),e._uU(2,"Previous Step"),e.qZA(),e.TgZ(3,"button",67),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.saveEmployeeTask())}),e._uU(4,"Save tasks"),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("disabled",!t.employeeSchedulesFormGroup.valid)}}let A=(()=>{class s{constructor(t,o){this.fb=t,this.api=o,this.viewMode=!1,this.closeIt=new e.vpe,this.employee_details={},this.employeeTasksFormGroupChanged=!0}ngOnInit(){this.employeeTasksFormGroup=this.fb.group({task_duration_type:["single_day",l.kI.required],task_date:[new Date,l.kI.required],task_from_date:[""],task_to_date:[""]}),this.employeeSchedulesFormGroup=this.fb.group({schedules:this.fb.array([])}),this.getEmployeeById(),this.taskId&&this.getTaskById()}ngAfterViewInit(){this.viewMode&&$(".mat-horizontal-stepper-header-container").addClass("d-none")}getEmployeeById(){$("#loading_overlay").show(),this.api.getEmployeeById(this.emp_id).subscribe(t=>{200==t.status?this.employee_details=t.data||{}:console.log(t),$("#loading_overlay").hide()})}getTaskById(){$("#loading_overlay").show(),this.api.getEmployeeTaskById(this.taskId).subscribe(t=>{200==t.status?(this.employeeTasksFormGroup.patchValue({task_duration_type:t.data.task_duration_type,task_date:t.data.task_date,task_from_date:t.data.task_from_date,task_to_date:t.data.task_to_date}),this.scheduleTypeChanged({value:t.data.task_duration_type}),t.data.schedules.forEach(o=>{this.schedules.push(this.scheduleFormGroup()),this.schedules.controls.at(-1).patchValue({tasks_day:o.tasks_day,tasks_date:o.tasks_date}),o.tasks.forEach(a=>{this.schedules.controls.at(-1).get("tasks").push(this.taskFormGroup()),this.schedules.controls.at(-1).get("tasks").controls.at(-1).patchValue({task_type:a.task_type,task_timing:a.task_timing,from:a.from,to:a.to,street:a.street,locality:a.locality,city:a.city,state:a.state,pinCode:a.pinCode,description:a.description}),this.taskTimingRequiremntChange({value:a.task_timing},this.schedules.controls.at(-1).get("tasks").controls.at(-1)),this.taskTypeChanged({value:a.task_type},this.schedules.controls.at(-1).get("tasks").controls.at(-1))})}),$("#loading_overlay").hide()):($("#loading_overlay").hide(),u().fire({icon:"error",title:t.message}))})}get schedules(){return this.employeeSchedulesFormGroup.get("schedules")}scheduleFormGroup(){return this.fb.group({tasks_date:[""],tasks_day:[""],tasks:this.fb.array([])})}taskFormGroup(){return this.fb.group({task_type:["other",l.kI.required],task_timing:[!1,l.kI.required],from:[""],to:[""],street:[""],locality:[""],city:[""],state:[""],pinCode:[""],description:["",l.kI.required]})}scheduleTypeChanged(t){"multi_day"==t.value?(this.employeeTasksFormGroup.get("task_from_date").setValidators(l.kI.required),this.employeeTasksFormGroup.get("task_to_date").setValidators(l.kI.required),this.employeeTasksFormGroup.get("task_date").clearValidators(),this.employeeTasksFormGroup.patchValue({task_from_date:new Date,task_to_date:"",task_date:""})):"single_day"==t.value?(this.employeeTasksFormGroup.get("task_date").setValidators(l.kI.required),this.employeeTasksFormGroup.get("task_to_date").clearValidators(),this.employeeTasksFormGroup.get("task_from_date").clearValidators(),this.employeeTasksFormGroup.patchValue({task_date:new Date,task_from_date:"",task_to_date:""})):"week_days_wise"==t.value&&(this.employeeTasksFormGroup.get("task_date").clearValidators(),this.employeeTasksFormGroup.get("task_to_date").clearValidators(),this.employeeTasksFormGroup.get("task_from_date").clearValidators()),this.employeeTasksFormGroup.get("task_date").updateValueAndValidity(),this.employeeTasksFormGroup.get("task_to_date").updateValueAndValidity(),this.employeeTasksFormGroup.get("task_from_date").updateValueAndValidity()}revisitingFirstStep(){this.employeeTasksFormGroupSubscription&&this.employeeTasksFormGroupSubscription.unsubscribe(),this.employeeTasksFormGroupChanged=!1,this.employeeTasksFormGroupSubscription=this.employeeTasksFormGroup.valueChanges.subscribe(t=>{console.log(t),this.employeeTasksFormGroupChanged=!0})}addSchedules(){for(;this.schedules.length>0;)this.schedules.removeAt(0);if("week_days_wise"==this.employeeTasksFormGroup.value.task_duration_type)this.api.weekDays.forEach(t=>{this.schedules.push(this.scheduleFormGroup()),this.schedules.controls.at(-1).patchValue({tasks_day:t}),this.employee_details.work_days.find(o=>o.day==t).holiday||this.schedules.controls.at(-1).get("tasks").push(this.taskFormGroup())});else if("multi_day"==this.employeeTasksFormGroup.value.task_duration_type){let t=new Date(this.employeeTasksFormGroup.value.task_from_date),o=new Date(this.employeeTasksFormGroup.value.task_to_date);t>o&&([t,o]=[o,t]),t.setHours(0,0,0,0),o.setHours(0,0,0,0);const a=[],n=new Date(t);for(;n<=o;)a.push(new Date(n)),n.setDate(n.getDate()+1);a.forEach(_=>{this.schedules.push(this.scheduleFormGroup()),this.schedules.controls.at(-1).patchValue({tasks_date:_,tasks_day:new Date(_).toLocaleDateString("en-US",{weekday:"long"})}),this.employee_details.work_days.find(De=>De.day==this.schedules.controls.at(-1).value.tasks_day).holiday||this.schedules.controls.at(-1).get("tasks").push(this.taskFormGroup())})}else"single_day"==this.employeeTasksFormGroup.value.task_duration_type&&(this.schedules.push(this.scheduleFormGroup()),this.schedules.controls.at(-1).patchValue({tasks_date:this.employeeTasksFormGroup.value.task_date,tasks_day:new Date(this.employeeTasksFormGroup.value.task_date).toLocaleDateString("en-US",{weekday:"long"})}),this.employee_details.work_days.find(t=>t.day==this.schedules.controls.at(-1).value.tasks_day).holiday||this.schedules.controls.at(-1).get("tasks").push(this.taskFormGroup()))}taskTimingRequiremntChange(t,o){t.value?(o.get("from").setValidators(l.kI.required),o.get("to").setValidators(l.kI.required)):(o.get("from").clearValidators(),o.get("to").clearValidators()),o.get("from").updateValueAndValidity(),o.get("to").updateValueAndValidity()}taskTypeChanged(t,o){["locality","city","state","pinCode"].forEach(a=>{"other"==t.value?(o.get(a).clearValidators(),o.patchValue({[a]:""})):o.get(a).setValidators(l.kI.required),o.get(a).updateValueAndValidity()}),"other"==t.value?o.get("description").setValidators(l.kI.required):o.get("description").clearValidators(),o.get("description").updateValueAndValidity()}addTask(t){this.schedules.controls[t].get("tasks").push(this.taskFormGroup())}saveEmployeeTask(){$("#loading_overlay").show();let t=this.employeeTasksFormGroup.value;t.employee_id=this.emp_id,t={...t,schedules:this.schedules.value},"week_days_wise"==t.task_duration_type&&(t.task_from_date=new Date,t.task_to_date=new Date("9999-12-31")),t.added_by=this.api.loggedInUser._id,this.api.saveEmployeeTasks(t).subscribe(o=>{$("#loading_overlay").hide(),200==o.status?u().fire({icon:"success",title:"Task assigned successfully",html:'Task successfully assigned to <label class="erp-button p-1 rounded m-1">'+this.employee_details.user_id.title+" "+this.employee_details.user_id.firstname+" "+this.employee_details.user_id.lastname+"</label>"}).then(()=>{this.closeIt.emit(!0)}):u().fire({icon:"error",title:o.message})})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(l.qu),e.Y36(c.s))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-assign-tasks"]],inputs:{emp_id:"emp_id",taskId:"taskId",viewMode:"viewMode"},outputs:{closeIt:"closeIt"},decls:12,vars:4,consts:[[1,"row","m-0"],[1,"col-sm-12"],["stepper",""],["matStepperIcon","edit"],["label","Tasks Scheduling",4,"ngIf"],["label","Tasks Details"],[1,"row","m-0",3,"formGroup"],["formArrayName","schedules",1,"col-sm-12"],["mat-stretch-tabs","true"],[3,"formGroupName","label",4,"ngFor","ngForOf"],["class","col-sm-12 my-3 d-flex justify-content-between",4,"ngIf"],["label","Tasks Scheduling"],[1,"col-sm-12","my-3"],[1,"input-hint-heading"],["formControlName","task_duration_type",3,"change"],[4,"ngFor","ngForOf"],["class","col-sm-12 my-3",4,"ngIf"],["class","col-sm-12 mt-3",4,"ngIf"],["class","col-sm-6",4,"ngIf"],[1,"col-sm-12","text-right","my-2"],["matStepperNext","",1,"btn","erp-button",3,"disabled","click"],[3,"value"],["appearance","fill"],["matInput","","formControlName","task_date","placeholder","Date of task",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],[1,"col-sm-12","mt-3"],[1,"col-sm-6"],["appearance","fill",1,"w-100"],["matInput","","formControlName","task_from_date","placeholder","Tasks Starting date",3,"matDatepicker"],["matInput","","formControlName","task_to_date","placeholder","Tasks Ending date",3,"matDatepicker"],["picker1",""],[3,"formGroupName","label"],["formArrayName","tasks"],["class","row mx-0 mt-3 border rounded",3,"formGroupName",4,"ngFor","ngForOf"],[1,"row","mx-0","my-3"],["class","col-sm-12 text-end p-0",4,"ngIf"],["class","col-sm-12 text-center my-4",4,"ngIf"],[1,"row","mx-0","mt-3","border","rounded",3,"formGroupName"],[1,"col-sm-12","bg-light","p-2"],[1,"input-hint-heading","mb-0"],[4,"ngIf"],["formControlName","task_timing",3,"change"],["formControlName","task_type",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","description","placeholder","Description"],["class","col-sm-12 text-end mb-2",4,"ngIf"],[1,"w-100"],["matInput","","placeholder","Task start time","readonly","","formControlName","from",3,"ngxMatTimepicker"],["matSuffix","",1,"text-primary",3,"click"],["dottedMinutesInGap","","enableKeyboardInput",""],["pickerA",""],["matInput","","placeholder","Task end time","readonly","","formControlName","to",3,"ngxMatTimepicker"],["pickerB",""],["type","text","matInput","","formControlName","street","placeholder","Street"],["type","text","matInput","","formControlName","locality","placeholder","Locality, Area"],[1,"col-sm-4"],["type","text","matInput","","formControlName","city","placeholder","City"],["type","text","matInput","","formControlName","state","placeholder","State"],["type","text","matInput","","formControlName","pinCode","placeholder","PinCode"],[1,"col-sm-12","text-end","mb-2"],[1,"btn","erp-button-danger",3,"click"],["class","col-sm-12 my-2",4,"ngIf"],["class","col-sm-12",4,"ngIf"],[1,"col-sm-12","my-2"],[1,"mb-0"],[1,"col-sm-12","text-end","p-0"],[1,"btn","erp-button",3,"disabled","click"],[1,"col-sm-12","text-center","my-4"],[1,"col-sm-12","my-3","d-flex","justify-content-between"],["matStepperPrevious","",1,"btn","erp-button",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-horizontal-stepper",null,2),e.YNc(4,E,2,0,"ng-template",3),e.YNc(5,M,14,7,"mat-step",4),e.TgZ(6,"mat-step",5)(7,"div",6)(8,"div",7)(9,"mat-tab-group",8),e.YNc(10,P,7,8,"mat-tab",9),e.qZA()(),e.YNc(11,R,5,1,"div",10),e.qZA()()()()()),2&t&&(e.xp6(5),e.Q6J("ngIf",!o.viewMode),e.xp6(2),e.Q6J("formGroup",o.employeeSchedulesFormGroup),e.xp6(3),e.Q6J("ngForOf",o.schedules.controls),e.xp6(1),e.Q6J("ngIf",!o.viewMode))},dependencies:[r.sg,r.O5,C.ey,f.Mq,f.hl,f.nW,d.KE,d.hX,d.R9,T.Nt,v.VQ,v.U0,w.gD,m.C0,m.Vq,m.Ic,m.fd,m.z9,g.uX,g.SP,q.Hw,Z.ft,Z.Bi,l.Fj,l.JJ,l.JL,l.sg,l.u,l.x0,l.CE,r.uU]}),s})();function X(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Oqu("asc"===t.sortDir?"\u25b2":"\u25bc")}}function W(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,t.task_date,"dd.MM.yyyy"))}}function ee(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.ALo(3,"date"),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.AsE("From ",e.xi3(2,2,t.task_from_date,"dd.MM.yyyy")," to ",e.xi3(3,5,t.task_to_date,"dd.MM.yyyy"),"")}}function te(s,i){1&s&&(e.TgZ(0,"span"),e._uU(1,"Every Week"),e.qZA())}function se(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tr")(1,"th",12),e._uU(2),e.qZA(),e.TgZ(3,"td"),e.YNc(4,W,3,4,"span",9),e.YNc(5,ee,4,8,"span",9),e.YNc(6,te,2,0,"span",9),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td")(13,"button",13),e.NdJ("click",function(){const n=e.CHM(t).$implicit,_=e.oxw(3);return _.openedTask=n,e.KtG(_.taskOpened=!0)}),e._uU(14,"Open"),e.qZA()()()}if(2&s){const t=i.$implicit,o=i.index;e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Q6J("ngIf","single_day"==t.task_duration_type),e.xp6(1),e.Q6J("ngIf","multi_day"==t.task_duration_type),e.xp6(1),e.Q6J("ngIf","week_days_wise"==t.task_duration_type),e.xp6(2),e.Oqu(t.added_by.title+" "+t.added_by.firstname+" "+t.added_by.lastname),e.xp6(2),e.Oqu(e.xi3(11,6,t.createdAt,"dd.MM.yyyy"))}}function oe(s,i){if(1&s&&(e.ynx(0),e.YNc(1,se,15,9,"tr",11),e.BQk()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.listItems)}}function ae(s,i){1&s&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",14),e._uU(3,"No Tasks found."),e.qZA()(),e.BQk())}const ie=function(){return[5,10,25,100]};function ne(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",4)(1,"table",5)(2,"thead",6)(3,"tr")(4,"th",7),e._uU(5,"#"),e.qZA(),e.TgZ(6,"th",7),e._uU(7,"Task/s Scheduled For"),e.qZA(),e.TgZ(8,"th",7),e._uU(9,"Assigned By"),e.qZA(),e.TgZ(10,"th",8),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.sort("createdAt"))}),e._uU(11,"Assigned On "),e.YNc(12,X,2,1,"span",9),e.qZA(),e.TgZ(13,"th",7),e._uU(14,"Action"),e.qZA()()(),e.TgZ(15,"tbody"),e.YNc(16,oe,2,1,"ng-container",9),e.YNc(17,ae,4,0,"ng-container",9),e.qZA()(),e.TgZ(18,"mat-paginator",10),e.NdJ("page",function(a){e.CHM(t);const n=e.oxw();return n.page=a.pageIndex,n.pageSize=a.pageSize,e.KtG(n.fetchEmployeesTasks())}),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(12),e.Q6J("ngIf","createdAt"==t.sortField),e.xp6(4),e.Q6J("ngIf",t.listItems.length>0),e.xp6(1),e.Q6J("ngIf",0==t.listItems.length),e.xp6(1),e.Q6J("length",t.totalEntries)("pageSize",t.pageSize)("pageSizeOptions",e.DdM(8,ie))("showFirstLastButtons",!0)("pageIndex",t.page)}}function le(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Oqu(e.xi3(2,1,t.openedTask.task_date,"dd.MM.yyyy"))}}function pe(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.ALo(3,"date"),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.AsE("From ",e.xi3(2,2,t.openedTask.task_from_date,"dd.MM.yyyy")," to ",e.xi3(3,5,t.openedTask.task_to_date,"dd.MM.yyyy"),"")}}function re(s,i){1&s&&(e.TgZ(0,"span"),e._uU(1,"Every Week"),e.qZA())}function _e(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"div")(3,"h6",17),e._uU(4," Viewing tasks scheduled for: "),e.YNc(5,le,3,4,"span",9),e.YNc(6,pe,4,8,"span",9),e.YNc(7,re,2,0,"span",9),e.qZA(),e.TgZ(8,"h6",18),e._uU(9),e.ALo(10,"date"),e.qZA()(),e.TgZ(11,"div")(12,"button",19),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return a.taskOpened=!1,e.KtG(a.openedTask={})}),e._uU(13,"Close Task"),e.qZA()()(),e._UZ(14,"app-assign-tasks",20),e.qZA()}if(2&s){const t=e.oxw();e.xp6(5),e.Q6J("ngIf","single_day"==t.openedTask.task_duration_type),e.xp6(1),e.Q6J("ngIf","multi_day"==t.openedTask.task_duration_type),e.xp6(1),e.Q6J("ngIf","week_days_wise"==t.openedTask.task_duration_type),e.xp6(2),e.hij("Assigned On: ",e.xi3(10,7,t.openedTask.createdAt,"dd.MM.yyyy"),""),e.xp6(5),e.Q6J("taskId",null==t.openedTask?null:t.openedTask._id)("emp_id",t.emp_id)("viewMode",!0)}}let de=(()=>{class s{constructor(t){this.api=t,this.listItems=[],this.page=0,this.pageSize=5,this.sortField="createdAt",this.sortDir="desc",this.totalEntries=0,this.taskOpened=!1,this.openedTask={}}ngOnInit(){this.fetchEmployeesTasks()}sort(t){this.sortField==t?this.sortDir="asc"===this.sortDir?"desc":"asc":(this.sortField=t,this.sortDir="asc"),this.page=0,this.fetchEmployeesTasks()}fetchEmployeesTasks(){$("#loading_overlay").show();let t=(new k.LE).set("page",this.page).set("pageSize",this.pageSize).set("sortField",this.sortField).set("sortDir",this.sortDir).set("employeeId",this.emp_id);this.api.getEmployeeTasks(t).subscribe(o=>{200==o.status?(this.totalEntries=o.data.total||0,this.listItems=o.data.items||[]):console.log(o.message),$("#loading_overlay").hide()})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(c.s))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-employees-tasks"]],inputs:{emp_id:"emp_id"},decls:4,vars:2,consts:[[1,"row","m-0"],[1,"col-sm-12","p-0"],["class","table-responsive-sm mt-2",4,"ngIf"],["class","w-100",4,"ngIf"],[1,"table-responsive-sm","mt-2"],[1,"table"],[1,"table-dark"],["scope","col"],["scope","col","role","button",3,"click"],[4,"ngIf"],[3,"length","pageSize","pageSizeOptions","showFirstLastButtons","pageIndex","page"],[4,"ngFor","ngForOf"],["scope","row"],[1,"btn","btn-sm","erp-button",3,"click"],["colspan","5",1,"text-center"],[1,"w-100"],[1,"w-100","bg-info","d-flex","justify-content-between","align-items-center","my-2","p-2","rounded"],[1,"mb-1"],[1,"mb-0"],[1,"btn","btn-sm","erp-button-danger",3,"click"],[3,"taskId","emp_id","viewMode"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,ne,19,9,"div",2),e.YNc(3,_e,15,10,"div",3),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngIf",!o.taskOpened),e.xp6(1),e.Q6J("ngIf",o.taskOpened))},dependencies:[r.sg,r.O5,x.NW,A,r.uU]}),s})();function me(s,i){if(1&s&&(e.TgZ(0,"label",26),e._uU(1),e.qZA()),2&s){const t=i.$implicit;e.xp6(1),e.Oqu(t)}}function ce(s,i){if(1&s&&(e.TgZ(0,"p",27)(1,"strong"),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&s){const t=i.$implicit,o=i.index;e.xp6(2),e.AsE("",o+1,". ",t.firm_id.name,""),e.xp6(1),e.hij(" (Monthly Salary ",t.salary,")")}}function ue(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"th",29),e._uU(2),e.qZA(),e.TgZ(3,"th",29),e._uU(4,"Holiday"),e.qZA(),e.BQk()),2&s){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.day)}}function ge(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"td",30),e._uU(2),e.qZA(),e.TgZ(3,"td",30),e._uU(4),e.qZA(),e.BQk()),2&s){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.day),e.xp6(2),e.AsE("From: ",t.from," - To:",t.to,"")}}function ye(s,i){if(1&s&&(e.TgZ(0,"tr"),e.YNc(1,ue,5,1,"ng-container",28),e.YNc(2,ge,5,3,"ng-container",28),e.qZA()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",t.holiday),e.xp6(1),e.Q6J("ngIf",!t.holiday)}}function fe(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",31)(1,"button",32),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.assigning_tasks=!0)}),e._uU(2,"Assign Tasks"),e.qZA()()}}function he(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",33)(1,"div",34)(2,"div",35)(3,"h6",15),e._uU(4),e.qZA(),e.TgZ(5,"i",36),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.abortAssigningTasks())}),e.qZA()(),e.TgZ(6,"app-assign-tasks",37),e.NdJ("closeIt",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.assigning_tasks=!1)}),e.qZA()()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.hij("Assign Tasks to ",t.employee_details.user_id.title+" "+t.employee_details.user_id.firstname+" "+t.employee_details.user_id.lastname,":"),e.xp6(2),e.Q6J("emp_id",t.employee_details._id)}}function ke(s,i){if(1&s&&(e.TgZ(0,"div",38),e._UZ(1,"app-employees-tasks",39),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.Q6J("emp_id",t.employee_details._id)}}function Te(s,i){if(1&s&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),e._uU(4),e.qZA(),e.TgZ(5,"h6",5),e._uU(6),e.qZA(),e.YNc(7,me,2,1,"label",6),e.qZA()(),e.TgZ(8,"div",7)(9,"div",8)(10,"mat-tab-group",9)(11,"mat-tab",10)(12,"div",11)(13,"div",12)(14,"p",13),e._uU(15,"E-Mail: "),e.TgZ(16,"strong"),e._uU(17),e.qZA()()(),e.TgZ(18,"div",12)(19,"p",13),e._uU(20,"Contact No.: "),e.TgZ(21,"strong"),e._uU(22),e.qZA()()(),e.TgZ(23,"div",12)(24,"p",13),e._uU(25,"Joining Date: "),e.TgZ(26,"strong"),e._uU(27),e.ALo(28,"date"),e.qZA()()(),e.TgZ(29,"div",12)(30,"p",13),e._uU(31,"Added on: "),e.TgZ(32,"strong"),e._uU(33),e.ALo(34,"date"),e.qZA()()(),e.TgZ(35,"div",14)(36,"div",13)(37,"p",15),e._uU(38,"Works In:"),e.qZA(),e.YNc(39,ce,4,3,"p",16),e.qZA()()()(),e.TgZ(40,"mat-tab",17)(41,"div",11)(42,"div",18)(43,"table",19)(44,"thead")(45,"tr")(46,"th",20),e._uU(47,"Day"),e.qZA(),e.TgZ(48,"th",20),e._uU(49,"Shift timing"),e.qZA()()(),e.TgZ(50,"tbody"),e.YNc(51,ye,3,2,"tr",21),e.qZA()()()()(),e.TgZ(52,"mat-tab",22)(53,"div",11),e.YNc(54,fe,3,0,"div",23),e.YNc(55,he,7,2,"div",24),e.YNc(56,ke,2,1,"div",25),e.qZA()()()()()()),2&s){const t=e.oxw();e.xp6(4),e.Oqu(t.employee_details.user_id.firstname.trim().charAt(0)+t.employee_details.user_id.lastname.trim().charAt(0)),e.xp6(2),e.Oqu(t.employee_details.user_id.title+" "+t.employee_details.user_id.firstname+" "+t.employee_details.user_id.lastname),e.xp6(1),e.Q6J("ngForOf",t.employee_details.roles),e.xp6(10),e.Oqu(t.employee_details.user_id.email||"Unavailable"),e.xp6(5),e.Oqu(t.employee_details.user_id.contact_no),e.xp6(5),e.Oqu(e.xi3(28,12,t.employee_details.joining_date,"dd/MM/yyyy")),e.xp6(6),e.Oqu(e.xi3(34,15,t.employee_details.createdAt,"dd/MM/yyyy")),e.xp6(6),e.Q6J("ngForOf",t.employee_details.monthly_salary_by_firms),e.xp6(12),e.Q6J("ngForOf",t.employee_details.work_days),e.xp6(3),e.Q6J("ngIf",!t.assigning_tasks),e.xp6(1),e.Q6J("ngIf",t.assigning_tasks),e.xp6(1),e.Q6J("ngIf",!t.assigning_tasks)}}let xe=(()=>{class s{constructor(t){this.api=t,this.employee_details={},this.assigning_tasks=!1}ngOnInit(){this.getEmployeeById()}getEmployeeById(){$("#loading_overlay").show(),this.api.getEmployeeById(this.emp_id).subscribe(t=>{200==t.status?this.employee_details=t.data||{}:console.log(t),$("#loading_overlay").hide()})}abortAssigningTasks(){u().fire({icon:"info",title:"Don't want to assign tasks to employee ?",confirmButtonText:"Yes, I don't want to assign tasks",showCancelButton:!0,cancelButtonText:"Cancel, Continue assigning tasks"}).then(t=>{t.isConfirmed&&(this.assigning_tasks=!1)})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(c.s))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-employee-details"]],inputs:{emp_id:"emp_id"},decls:1,vars:1,consts:[["class","row m-0 bg-light p-2",4,"ngIf"],[1,"row","m-0","bg-light","p-2"],[1,"col-sm-3","ps-2","pe-2"],[1,"text-center","py-3","px-2","shadow","border","rounded","bg-white","h-100"],[1,"avatar","bg-info"],[1,"input-hint-heading","py-3","mt-2","border-top","border-bottom"],["class","font-size-sm m-2 bg-light border rounded p-2",4,"ngFor","ngForOf"],[1,"col-sm-9","ps-2","pe-2"],[1,"bg-white","shadow","border","rounded","h-100"],["mat-stretch-tabs","true"],["label","Personal & Official Details"],[1,"row","m-0"],[1,"col-sm-6","my-3"],[1,"mb-0","bg-light","border","p-3","rounded","text-secondary"],[1,"col-sm-12","my-3"],[1,"mb-0"],["class","my-1",4,"ngFor","ngForOf"],["label","Daily Shift timings"],[1,"col-sm-12","table-responsive-sm"],[1,"table","table-striped"],[1,"text-center"],[4,"ngFor","ngForOf"],["label","Tasks"],["class","w-100 text-right mt-2",4,"ngIf"],["class","col-sm-12 my-2",4,"ngIf"],["class","col-sm-12 mb-2",4,"ngIf"],[1,"font-size-sm","m-2","bg-light","border","rounded","p-2"],[1,"my-1"],[4,"ngIf"],[1,"text-center","p-3","text-secondary"],[1,"text-center","p-3"],[1,"w-100","text-right","mt-2"],[1,"btn","erp-button",3,"click"],[1,"col-sm-12","my-2"],[1,"w-100","border","border-info","rounded"],[1,"d-flex","justify-content-between","bg-info","p-1"],["role","button",1,"fa","fa-times-circle","font-size-lg",3,"click"],[3,"emp_id","closeIt"],[1,"col-sm-12","mb-2"],[3,"emp_id"]],template:function(t,o){1&t&&e.YNc(0,Te,57,18,"div",0),2&t&&e.Q6J("ngIf",null==o.employee_details?null:o.employee_details._id)},dependencies:[r.sg,r.O5,g.uX,g.SP,A,de,r.uU],styles:[".avatar[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2.5rem;font-weight:700;text-transform:uppercase;margin:0 auto}"]}),s})();function ve(s,i){1&s&&(e.TgZ(0,"q",25),e._uU(1,"Click here to open filters"),e.qZA())}function Ze(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",29)(1,"p",30),e._uU(2,"Searched: "),e.TgZ(3,"strong"),e._uU(4),e.qZA()(),e.TgZ(5,"button",31),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return a.filters.search.applied=!1,a.filters.search.keyword="",a.page=0,e.KtG(a.fetchEmployees())}),e._uU(6,"X"),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Oqu(t.filters.search.keyword)}}function Ae(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",32)(1,"mat-form-field",33)(2,"mat-label"),e._uU(3,"Search by Employee Name"),e.qZA(),e.TgZ(4,"input",34),e.NdJ("ngModelChange",function(a){e.CHM(t);const n=e.oxw(2);return e.KtG(n.filters.search.keyword=a)}),e.qZA()(),e.TgZ(5,"button",35),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return a.filters.search.applied=!0,a.page=0,e.KtG(a.fetchEmployees())}),e._uU(6,"Search"),e.qZA()()}if(2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("ngModel",t.filters.search.keyword),e.xp6(1),e.Q6J("disabled",!t.filters.search.keyword)}}function be(s,i){if(1&s&&(e.TgZ(0,"div",26),e.YNc(1,Ze,7,1,"div",27),e.YNc(2,Ae,7,2,"div",28),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.filters.search.applied),e.xp6(1),e.Q6J("ngIf",!t.filters.search.applied)}}function Ce(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Oqu("asc"===t.sortDir?"\u25b2":"\u25bc")}}function we(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Oqu("asc"===t.sortDir?"\u25b2":"\u25bc")}}function qe(s,i){if(1&s&&(e.TgZ(0,"p",40),e._uU(1),e.qZA()),2&s){const t=i.$implicit;e.xp6(1),e.Oqu(t.firm_name)}}function Ee(s,i){if(1&s&&(e.TgZ(0,"p",40),e._uU(1),e.qZA()),2&s){const t=i.$implicit;e.xp6(1),e.Oqu(t)}}function Ie(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tr")(1,"th",37),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e.YNc(6,qe,2,1,"p",38),e.qZA(),e.TgZ(7,"td"),e.YNc(8,Ee,2,1,"p",38),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td")(15,"button",39),e.NdJ("click",function(){const n=e.CHM(t).$implicit,_=e.oxw(2);return e.KtG(_.openedEmployee=n)}),e._uU(16,"Open"),e.qZA()()()}if(2&s){const t=i.$implicit,o=i.index;e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.user.title+" "+t.user.firstname+" "+t.user.lastname),e.xp6(2),e.Q6J("ngForOf",t.salaries),e.xp6(2),e.Q6J("ngForOf",t.roles),e.xp6(2),e.Oqu(t.total_salary),e.xp6(2),e.Oqu(e.xi3(13,6,t.joining_date,"dd/MM/yyyy"))}}function Fe(s,i){if(1&s&&(e.ynx(0),e.YNc(1,Ie,17,9,"tr",36),e.BQk()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.listItems)}}function Ue(s,i){1&s&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",41),e._uU(3,"No Employees found."),e.qZA()(),e.BQk())}function Ne(s,i){if(1&s&&e._UZ(0,"app-employee-details",42),2&s){const t=e.oxw();e.Q6J("emp_id",t.openedEmployee._id)}}const Je=function(){return[5,10,25,100]},Me=[{path:"",component:(()=>{class s{constructor(t){this.api=t,this.listItems=[],this.page=0,this.pageSize=10,this.sortField="joining_date",this.sortDir="desc",this.totalEntries=0,this.showFilters=!1,this.filters={search:{keyword:"",applied:!1}},this.openedEmployee={}}ngOnInit(){this.fetchEmployees()}sort(t){this.sortField==t?this.sortDir="asc"===this.sortDir?"desc":"asc":(this.sortField=t,this.sortDir="asc"),this.page=0,this.fetchEmployees()}fetchEmployees(){$("#loading_overlay").show();let t=[];this.api.loggedInUser.firms_with_roles.map(a=>t.push(a.firm_id));let o=(new k.LE).set("page",this.page).set("pageSize",this.pageSize).set("sortField",this.sortField).set("sortDir",this.sortDir).set("firmIds",t.join(","));this.filters.search.applied&&(o=o.set("search",this.filters.search.keyword)),this.api.getEmployees(o).subscribe(a=>{200==a.status?(this.totalEntries=a.data.total||0,this.listItems=a.data.items||[]):console.log(a.message),$("#loading_overlay").hide()})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(c.s))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-employees"]],decls:46,vars:13,consts:[[1,"row","m-0"],[1,"col-sm-12","p-0"],[1,"heading-div-bg","text-white","rounded","p-2","d-flex","justify-content-between"],[1,"text-center","align-self-center","mb-0","text-secondary"],["routerLink","/erp/add-employee",1,"btn","btn-sm","erp-button","align-self-center"],[1,"border-info","rounded"],["role","button",1,"w-100","bg-info","p-1",3,"click"],[1,"mb-0"],["class","font-size-sm",4,"ngIf"],["class","w-100 p-2 d-flex flex-wrap remove-field-bottom-space",4,"ngIf"],[1,"table-responsive-sm","mt-2"],[1,"table"],[1,"table-dark"],["scope","col"],["scope","col","role","button",3,"click"],[4,"ngIf"],[3,"length","pageSize","pageSizeOptions","showFirstLastButtons","pageIndex","page"],["data-bs-backdrop","static","data-bs-keyboard","false","id","viewEmployeeModal","tabindex","-1","aria-labelledby","viewEmployeeModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","modal-xl"],[1,"modal-content"],[1,"modal-header"],["id","viewEmployeeModalLabel",1,"modal-title","text-primary"],["type","button","id","viewEmployeeModalCloseButton","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body","p-0"],[3,"emp_id",4,"ngIf"],[1,"font-size-sm"],[1,"w-100","p-2","d-flex","flex-wrap","remove-field-bottom-space"],["class","d-flex align-items-center rounded border-info p-1 m-2",4,"ngIf"],["class","w-100 d-flex mb-2",4,"ngIf"],[1,"d-flex","align-items-center","rounded","border-info","p-1","m-2"],[1,"mb-0","mr-2"],[1,"btn","btn-sm","erp-button-danger",3,"click"],[1,"w-100","d-flex","mb-2"],["appearance","fill",1,"w-100","mr-2"],["type","text","placeholder","Search...","matInput","",3,"ngModel","ngModelChange"],[1,"btn","erp-button",3,"disabled","click"],[4,"ngFor","ngForOf"],["scope","row"],["class","mb-0 font-size-sm",4,"ngFor","ngForOf"],["data-bs-toggle","modal","data-bs-target","#viewEmployeeModal",1,"btn","btn-sm","erp-button",3,"click"],[1,"mb-0","font-size-sm"],["colspan","7",1,"text-center"],[3,"emp_id"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h6",3),e._uU(4,"Employees"),e.qZA(),e.TgZ(5,"button",4),e._uU(6,"Add Employee"),e.qZA()(),e.TgZ(7,"div",5)(8,"div",6),e.NdJ("click",function(){return o.showFilters=!o.showFilters}),e.TgZ(9,"h6",7),e._uU(10,"Filters: "),e.YNc(11,ve,2,0,"q",8),e.qZA()(),e.YNc(12,be,3,2,"div",9),e.qZA(),e.TgZ(13,"div",10)(14,"table",11)(15,"thead",12)(16,"tr")(17,"th",13),e._uU(18,"#"),e.qZA(),e.TgZ(19,"th",13),e._uU(20,"Name"),e.qZA(),e.TgZ(21,"th",13),e._uU(22,"Works in"),e.qZA(),e.TgZ(23,"th",13),e._uU(24,"Roles"),e.qZA(),e.TgZ(25,"th",14),e.NdJ("click",function(){return o.sort("total_salary")}),e._uU(26,"Salary "),e.YNc(27,Ce,2,1,"span",15),e.qZA(),e.TgZ(28,"th",14),e.NdJ("click",function(){return o.sort("joining_date")}),e._uU(29,"Joining Date "),e.YNc(30,we,2,1,"span",15),e.qZA(),e.TgZ(31,"th",13),e._uU(32,"Action"),e.qZA()()(),e.TgZ(33,"tbody"),e.YNc(34,Fe,2,1,"ng-container",15),e.YNc(35,Ue,4,0,"ng-container",15),e.qZA()(),e.TgZ(36,"mat-paginator",16),e.NdJ("page",function(n){return o.page=n.pageIndex,o.pageSize=n.pageSize,o.fetchEmployees()}),e.qZA()()()(),e.TgZ(37,"div",17)(38,"div",18)(39,"div",19)(40,"div",20)(41,"h6",21),e._uU(42,"Employee Information:"),e.qZA(),e._UZ(43,"button",22),e.qZA(),e.TgZ(44,"div",23),e.YNc(45,Ne,1,1,"app-employee-details",24),e.qZA()()()()),2&t&&(e.xp6(11),e.Q6J("ngIf",!o.showFilters),e.xp6(1),e.Q6J("ngIf",o.showFilters),e.xp6(15),e.Q6J("ngIf","total_salary"==o.sortField),e.xp6(3),e.Q6J("ngIf","joining_date"==o.sortField),e.xp6(4),e.Q6J("ngIf",o.listItems.length>0),e.xp6(1),e.Q6J("ngIf",0==o.listItems.length),e.xp6(1),e.Q6J("length",o.totalEntries)("pageSize",o.pageSize)("pageSizeOptions",e.DdM(12,Je))("showFirstLastButtons",!0)("pageIndex",o.page),e.xp6(9),e.Q6J("ngIf",null==o.openedEmployee?null:o.openedEmployee._id))},dependencies:[r.sg,r.O5,d.KE,d.hX,T.Nt,x.NW,l.Fj,l.JJ,l.On,xe,y.rH,r.uU]}),s})()}];let Qe=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[y.Bz.forChild(Me),y.Bz]}),s})();var Ge=p(500);let Oe=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[r.ez,Ge.q,Qe]}),s})()}}]);