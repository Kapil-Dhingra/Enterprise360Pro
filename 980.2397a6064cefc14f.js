"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[980],{5980:(O,p,o)=>{o.r(p),o.d(p,{QuantityTypesModule:()=>k});var l=o(6814),m=o(1896),s=o(6223),_=o(3519),c=o.n(_),t=o(5879),f=o(8789),v=o(3680),h=o(5986),y=o(4170),g=o(2032),T=o(8525);function q(n,a){1&n&&(t.TgZ(0,"q",29),t._uU(1,"No equivalents"),t.qZA())}function Q(n,a){if(1&n&&(t.TgZ(0,"p",29),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.Oqu(e.equivalent_quantity+" "+e.equivalent_name)}}function x(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"th",28),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"p",29),t._uU(5),t.qZA(),t.TgZ(6,"p",30),t._uU(7),t.qZA()(),t.TgZ(8,"td"),t.YNc(9,q,2,0,"q",31),t.YNc(10,Q,2,1,"p",32),t.qZA(),t.TgZ(11,"td")(12,"button",33),t.NdJ("click",function(){const d=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.openQuantityType(d))}),t._uU(13,"Open"),t.qZA()()()}if(2&n){const e=a.$implicit,i=a.index;t.xp6(2),t.Oqu(i+1),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(e.description),t.xp6(2),t.Q6J("ngIf",0==e.equivalents.length),t.xp6(1),t.Q6J("ngForOf",e.equivalents)}}function b(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"mat-checkbox",35),t.NdJ("change",function(){const d=t.CHM(e).$implicit,r=t.oxw(2);return t.KtG(r.updateFirmId(d._id))}),t._uU(1),t.qZA()}if(2&n){const e=a.$implicit,i=t.oxw(2);t.Q6J("checked",i.addEditQuantityTypeFormGroup.value.firm_ids.includes(e._id)),t.xp6(1),t.Oqu(e.name)}}function Z(n,a){if(1&n&&(t.TgZ(0,"div",17)(1,"h6",23),t._uU(2,"Please select your business holdings in which you want to use this quantity type:"),t.qZA(),t.YNc(3,b,2,2,"mat-checkbox",34),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.ownFirms)}}function F(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"i",45),t.NdJ("click",function(){t.CHM(e);const u=t.oxw().index,d=t.oxw();return t.KtG(d.equivalents.removeAt(u))}),t.qZA()}}function C(n,a){if(1&n&&(t.TgZ(0,"q",48),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("(",e.description,")")}}function A(n,a){if(1&n&&(t.TgZ(0,"mat-option",46),t._uU(1),t.YNc(2,C,2,1,"q",47),t.qZA()),2&n){const e=a.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij("",e.name," "),t.xp6(1),t.Q6J("ngIf",e.description)}}function G(n,a){if(1&n&&(t.TgZ(0,"div",36)(1,"div",37)(2,"h6",38),t._uU(3),t.YNc(4,F,1,0,"i",39),t.qZA(),t.TgZ(5,"div",0)(6,"div",40)(7,"mat-form-field",41)(8,"mat-label"),t._uU(9,"Quantity"),t.qZA(),t._UZ(10,"input",42),t.qZA(),t.TgZ(11,"mat-form-field",18)(12,"mat-label"),t._uU(13,"Select equivalent"),t.qZA(),t.TgZ(14,"mat-select",43),t.YNc(15,A,3,3,"mat-option",44),t.qZA()()()()()()),2&n){const e=a.$implicit,i=a.index,u=t.oxw();t.Q6J("formGroupName",i),t.xp6(3),t.hij(" Equivalent no.",i+1,": "),t.xp6(1),t.Q6J("ngIf",!e.value.existing),t.xp6(11),t.Q6J("ngForOf",u.equivalents_to_select)}}function E(n,a){1&n&&(t.TgZ(0,"div",0)(1,"div",49)(2,"q",23),t._uU(3,"There is no equivalent of this quantity type."),t.qZA()()())}function N(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",0)(1,"div",50)(2,"button",51),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.add_equivalent())}),t._uU(3,"Add Equivalent"),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("disabled",e.equivalents.length>0&&!e.equivalents.controls.at(-1).valid)}}function U(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",52)(1,"button",53),t.NdJ("click",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.save_quantity_type())}),t._uU(2),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("disabled",e.addEditQuantityTypeFormGroup.value.quantity_type_id&&(!e.valueChanged||!e.addEditQuantityTypeFormGroup.valid)||!e.addEditQuantityTypeFormGroup.value.quantity_type_id&&!e.addEditQuantityTypeFormGroup.valid),t.xp6(1),t.hij("",e.addEditQuantityTypeFormGroup.value.quantity_type_id?"Update":"Save"," Quantity Type")}}const w=[{path:"",component:(()=>{class n{constructor(e,i){this.fb=e,this.api=i,this.listItems=[],this.ownFirms=[],this.equivalents_to_select=[],this.valueChanged=!1}ngOnInit(){this.addEditQuantityTypeFormGroup=this.fb.group({quantity_type_id:[""],name:["",s.kI.required],description:[""],firm_ids:[[],s.kI.required],equivalents:this.fb.array([]),universal:[!1]}),this.getQuantityTypes(),this.getOwnFirms()}getOwnFirms(){let e={firm_ids:[]};this.api.loggedInUser.firms_with_roles.map(i=>e.firm_ids.push(i.firm_id)),this.api.getFirmsById(e).subscribe(i=>{this.ownFirms=200==i.status&&i.data.length>0?i.data:[]})}getQuantityTypes(){$("#loading_overlay").show();let e={firm_ids:[]};this.api.loggedInUser.firms_with_roles.map(i=>e.firm_ids.push(i.firm_id)),this.api.getQuantityTypesByFirmIds(e).subscribe(i=>{200==i.status?this.listItems=i.data||[]:console.log(i.message),this.equivalents_to_select=JSON.parse(JSON.stringify(this.listItems)),$("#loading_overlay").hide()})}updateFirmId(e){let i=this.addEditQuantityTypeFormGroup.value.firm_ids;i.includes(e)?i.splice(i.findIndex(u=>u==e),1):i.push(e),this.addEditQuantityTypeFormGroup.patchValue({firm_ids:i})}get equivalents(){return this.addEditQuantityTypeFormGroup.get("equivalents")}equivalentsFormGroup(){return this.fb.group({quantity_type_id:["",s.kI.required],quantity:[0,s.kI.required],existing:[!1]})}add_equivalent(){this.equivalents.push(this.equivalentsFormGroup())}save_quantity_type(){$("#loading_overlay").show();let e=this.addEditQuantityTypeFormGroup.value;if(e.quantity_type_id)for(let i=e.equivalents.length-1;i>=0;i--)e.equivalents[i].existing&&e.equivalents.splice(i,1);this.api.saveQuantityType(e).subscribe(i=>{200==i.status?($("#addQuantityTypeModalCloseButton").trigger("click"),c().fire({icon:"success",title:`Quantity type ${e.quantity_type_id?"updated":"added"} successfully.`,html:`Quantity type <label class='erp-button p-1 m-1 rounded text-white'>${this.addEditQuantityTypeFormGroup.value.name}</label> ${e.quantity_type_id?"updated":"added"} successfully.`}).then(()=>{this.getQuantityTypes()})):500==i.status&&($("#loading_overlay").hide(),c().fire({icon:"error",title:i.message}))})}quantityTypeFormGroupReset(){for(this.formValueChangeSub&&this.formValueChangeSub.unsubscribe(),this.valueChanged=!1;this.equivalents.length>0;)this.equivalents.removeAt(0);this.addEditQuantityTypeFormGroup.reset(),this.addEditQuantityTypeFormGroup.patchValue({firm_ids:[],universal:!1})}openQuantityType(e){this.quantityTypeFormGroupReset(),this.addEditQuantityTypeFormGroup.patchValue({quantity_type_id:e._id,name:e.name,description:e.description,firm_ids:e.firm_ids,universal:e.universal}),e.equivalents.forEach(i=>{this.add_equivalent(),this.equivalents.controls[this.equivalents.length-1].patchValue({quantity_type_id:i.equivalent_quantity_type_id,quantity:i.equivalent_quantity,existing:!0}),this.equivalents.controls[this.equivalents.length-1].get("quantity_type_id").disable(),this.equivalents.controls[this.equivalents.length-1].get("quantity").disable()}),this.formValueChangeSub=this.addEditQuantityTypeFormGroup.valueChanges.subscribe(()=>{this.valueChanged=!0}),$("#addQuantityTypeModal").modal("show")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.qu),t.Y36(f.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-quantity-types"]],decls:50,vars:8,consts:[[1,"row","m-0"],[1,"col-sm-12","p-0"],[1,"heading-div-bg","text-white","rounded","p-2","d-flex","justify-content-between"],[1,"text-center","align-self-center","mb-0","text-secondary"],["data-bs-toggle","modal","data-bs-target","#addQuantityTypeModal",1,"btn","btn-sm","erp-button","align-self-center",3,"click"],[1,"table-responsive-sm","mt-2"],[1,"table"],[1,"table-dark"],["scope","col"],[4,"ngFor","ngForOf"],["data-bs-backdrop","static","data-bs-keyboard","false","id","addQuantityTypeModal","tabindex","-1","aria-labelledby","addQuantityTypeModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered","modal-dialog-scrollable","modal-lg"],[1,"modal-content"],[1,"modal-header"],["id","addQuantityTypeModalLabel",1,"modal-title","text-primary"],["type","button","id","addQuantityTypeModalCloseButton","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body",3,"formGroup"],[1,"col-sm-12"],["appearance","fill",1,"w-100"],["type","text","placeholder","Quantity Name","formControlName","name","matInput",""],["rows","3","placeholder","Description","formControlName","description","matInput",""],["class","col-sm-12",4,"ngIf"],[1,"row","mx-0","mt-4"],[1,"input-hint-heading"],["formArrayName","equivalents"],["class","row mx-2",3,"formGroupName",4,"ngFor","ngForOf"],["class","row m-0",4,"ngIf"],["class","modal-footer",4,"ngIf"],["scope","row"],[1,"mb-0"],[1,"mb-0","font-size-sm"],["class","mb-0",4,"ngIf"],["class","mb-0",4,"ngFor","ngForOf"],[1,"btn","btn-sm","erp-button",3,"click"],["class","mx-2",3,"checked","change",4,"ngFor","ngForOf"],[1,"mx-2",3,"checked","change"],[1,"row","mx-2",3,"formGroupName"],[1,"col-sm-12","border-info","rounded","mb-3","pb-2","px-0","remove-field-bottom-space"],[1,"bg-info","font-size-sm","p-1","rounded-top","d-flex","justify-content-between"],["class","fa fa-times-circle font-size-lg","role","button","aria-hidden","true",3,"click",4,"ngIf"],[1,"col-sm-12","d-flex"],["appearance","fill",1,"mr-2"],["type","number","placeholder","Quantity","formControlName","quantity","matInput",""],["formControlName","quantity_type_id"],[3,"value",4,"ngFor","ngForOf"],["role","button","aria-hidden","true",1,"fa","fa-times-circle","font-size-lg",3,"click"],[3,"value"],["class","input-hint-heading font-size-sm",4,"ngIf"],[1,"input-hint-heading","font-size-sm"],[1,"col-sm-12","text-center"],[1,"col-sm-12","text-right"],[1,"btn","btn-sm","erp-button",3,"disabled","click"],[1,"modal-footer"],[1,"btn","erp-button",3,"disabled","click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h6",3),t._uU(4,"Quantity types"),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){return i.quantityTypeFormGroupReset()}),t._uU(6,"Add Quantity Type"),t.qZA()(),t.TgZ(7,"div",5)(8,"table",6)(9,"thead",7)(10,"tr")(11,"th",8),t._uU(12,"#"),t.qZA(),t.TgZ(13,"th",8),t._uU(14,"Name"),t.qZA(),t.TgZ(15,"th",8),t._uU(16,"Equivalent to"),t.qZA(),t.TgZ(17,"th",8),t._uU(18,"Action"),t.qZA()()(),t.TgZ(19,"tbody"),t.YNc(20,x,14,5,"tr",9),t.qZA()()()()(),t.TgZ(21,"div",10)(22,"div",11)(23,"div",12)(24,"div",13)(25,"h6",14),t._uU(26),t.qZA(),t._UZ(27,"button",15),t.qZA(),t.TgZ(28,"div",16)(29,"div",0)(30,"div",17)(31,"mat-form-field",18)(32,"mat-label"),t._uU(33,"Quantity Name (For e.g. Box, Carton etc.)"),t.qZA(),t._UZ(34,"input",19),t.qZA()(),t.TgZ(35,"div",17)(36,"mat-form-field",18)(37,"mat-label"),t._uU(38,"Description (For e.g. Box of 24 pieces)"),t.qZA(),t._UZ(39,"textarea",20),t.qZA()(),t.YNc(40,Z,4,1,"div",21),t.qZA(),t.TgZ(41,"div",22)(42,"div",17)(43,"h6",23),t._uU(44,"Equivalents:"),t.qZA()()(),t.ynx(45,24),t.YNc(46,G,16,4,"div",25),t.YNc(47,E,4,0,"div",26),t.YNc(48,N,4,1,"div",26),t.BQk(),t.qZA(),t.YNc(49,U,3,2,"div",27),t.qZA()()()),2&e&&(t.xp6(20),t.Q6J("ngForOf",i.listItems),t.xp6(6),t.hij("",i.addEditQuantityTypeFormGroup.value.quantity_type_id?i.addEditQuantityTypeFormGroup.value.universal?"":"Edit":"Add"," Quantity Type"),t.xp6(2),t.Q6J("formGroup",i.addEditQuantityTypeFormGroup),t.xp6(12),t.Q6J("ngIf",!i.addEditQuantityTypeFormGroup.value.universal),t.xp6(6),t.Q6J("ngForOf",i.equivalents.controls),t.xp6(1),t.Q6J("ngIf",!i.equivalents.length),t.xp6(1),t.Q6J("ngIf",!i.addEditQuantityTypeFormGroup.value.universal),t.xp6(1),t.Q6J("ngIf",!i.addEditQuantityTypeFormGroup.value.universal))},dependencies:[l.sg,l.O5,v.ey,h.oG,y.KE,y.hX,g.Nt,T.gD,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,s.x0,s.CE]}),n})()}];let J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Bz.forChild(w),m.Bz]}),n})();var I=o(500);let k=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[l.ez,I.q,J]}),n})()}}]);