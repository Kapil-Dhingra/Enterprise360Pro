"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[834],{7834:(G,p,a)=>{a.r(p),a.d(p,{AddOwnFirmModule:()=>w});var y=a(6814),f=a(1896);function h(e,l,r,o,n,i,d){try{var s=e[i](d),u=s.value}catch(I){return void r(I)}s.done?l(u):Promise.resolve(u).then(o,n)}function g(e){return function(){var l=this,r=arguments;return new Promise(function(o,n){var i=e.apply(l,r);function d(u){h(i,o,n,d,s,"next",u)}function s(u){h(i,o,n,d,s,"throw",u)}d(void 0)})}}var m=a(6223),F=a(3519),c=a.n(F),t=a(5879),Z=a(8789),v=a(4170),A=a(2032);const C=[{path:"",component:(()=>{class e{constructor(r,o,n,i){this.api=r,this.fb=o,this.route=n,this.router=i}ngOnInit(){this.firmFormGroup=this.fb.group({firm_id:[""],name:["",m.kI.required],gst_no:[""],contactno:[""],street:[""],locality:[""],city:["",m.kI.required],state:["",m.kI.required],pinCode:["",m.kI.required],country:["",m.kI.required]}),this.route.params.subscribe(r=>{r.firm_id&&(this.firmFormGroup.patchValue({firm_id:r.firm_id}),this.getFirmById())})}getFirmById(){$("#loading_overlay").show(),this.api.getFirmById(this.firmFormGroup.value.firm_id).subscribe(r=>{this.firmFormGroup.patchValue({name:r.name,gst_no:r.gst_no,contactno:r.contactno,street:r.street,locality:r.locality,city:r.city,state:r.state,pinCode:r.pinCode,country:r.country}),$("#loading_overlay").hide()})}saveFirm(){var r=this;$("#loading_overlay").show();let o=this.firmFormGroup.value.firm_id?"updateFirm":"addFirm",n=this.firmFormGroup.value;"addFirm"==o&&(n.registered_by=this.api.loggedInUser._id),this.api[o](n).subscribe(function(){var i=g(function*(d){200==d.status?("addFirm"==o&&(yield r.updateUserData(d.data._id)),$("#loading_overlay").hide(),c().fire({icon:"success",title:"Your business holding "+(r.firmFormGroup.value.firm_id?"updated":"added")+" successfully.",html:"Your business holding <label class='erp-button p-1 m-1 rounded text-white'>"+r.firmFormGroup.value.name+"</label> "+(r.firmFormGroup.value.firm_id?"Updated":"added")+" successfully."}).then(()=>{r.firmFormGroup.value.firm_id&&r.router.navigate(["/erp/own-firms"]),r.firmFormGroup.reset()})):($("#loading_overlay").hide(),c().fire({icon:"error",text:"Something went wrong."}))});return function(d){return i.apply(this,arguments)}}())}updateUserData(r){var o=this;return g(function*(){return new Promise(n=>{let i=JSON.parse(localStorage.getItem("userData"));i.firms_with_roles.push({firm_id:r,role:"admin"}),i.user_id=i._id,o.api.updateUserData(i).subscribe(d=>{200==d.status?(localStorage.setItem("userData",JSON.stringify(i)),o.api.loggedInUser=i):c().fire({icon:"error",text:"Something went wrong."}),n(!0)})})})()}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(Z.s),t.Y36(m.qu),t.Y36(f.gz),t.Y36(f.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-add-own-firm"]],decls:52,vars:4,consts:[[1,"row","m-0",3,"formGroup"],[1,"col-sm-12","my-3"],[1,"rounded","p-2","text-center","bg-light","border","text-info"],[1,"col-sm-6","mb-2"],["appearance","fill",1,"w-100"],["placeholder","Firm Name","matInput","","formControlName","name"],["placeholder","GST No.","matInput","","formControlName","gst_no"],["placeholder","Contact No.","matInput","","formControlName","contactno"],["placeholder","Street","matInput","","formControlName","street"],["placeholder","Locality/Area","matInput","","formControlName","locality"],["placeholder","City/Town","matInput","","formControlName","city"],["placeholder","State/Union Territory","matInput","","formControlName","state"],["placeholder","Pincode/Postal Code","matInput","","formControlName","pinCode"],["placeholder","Country","matInput","","formControlName","country"],[1,"col-sm-12","text-right"],[1,"btn","erp-button",3,"disabled","click"]],template:function(r,o){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._uU(3),t.qZA()(),t.TgZ(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),t._uU(7,"Firm Name"),t.qZA(),t._UZ(8,"input",5),t.qZA()(),t.TgZ(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),t._uU(12,"GST No."),t.qZA(),t._UZ(13,"input",6),t.qZA()(),t.TgZ(14,"div",3)(15,"mat-form-field",4)(16,"mat-label"),t._uU(17,"Contact No."),t.qZA(),t._UZ(18,"input",7),t.qZA()(),t.TgZ(19,"div",3)(20,"mat-form-field",4)(21,"mat-label"),t._uU(22,"Street"),t.qZA(),t._UZ(23,"input",8),t.qZA()(),t.TgZ(24,"div",3)(25,"mat-form-field",4)(26,"mat-label"),t._uU(27,"Locality/Area"),t.qZA(),t._UZ(28,"input",9),t.qZA()(),t.TgZ(29,"div",3)(30,"mat-form-field",4)(31,"mat-label"),t._uU(32,"City/Town"),t.qZA(),t._UZ(33,"input",10),t.qZA()(),t.TgZ(34,"div",3)(35,"mat-form-field",4)(36,"mat-label"),t._uU(37,"State/Union Territory"),t.qZA(),t._UZ(38,"input",11),t.qZA()(),t.TgZ(39,"div",3)(40,"mat-form-field",4)(41,"mat-label"),t._uU(42,"Pincode/Postal Code"),t.qZA(),t._UZ(43,"input",12),t.qZA()(),t.TgZ(44,"div",3)(45,"mat-form-field",4)(46,"mat-label"),t._uU(47,"Country"),t.qZA(),t._UZ(48,"input",13),t.qZA()(),t.TgZ(49,"div",14)(50,"button",15),t.NdJ("click",function(){return o.saveFirm()}),t._uU(51),t.qZA()()()),2&r&&(t.Q6J("formGroup",o.firmFormGroup),t.xp6(3),t.hij("",o.firmFormGroup.value.firm_id?"Update":"Add"," business holding"),t.xp6(47),t.Q6J("disabled",!o.firmFormGroup.valid),t.xp6(1),t.hij("",o.firmFormGroup.value.firm_id?"Update":"Save"," business holding"))},dependencies:[v.KE,v.hX,A.Nt,m.Fj,m.JJ,m.JL,m.sg,m.u]}),e})()}];let U=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.Bz.forChild(C),f.Bz]}),e})();var b=a(500);let w=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[y.ez,b.q,U]}),e})()}}]);